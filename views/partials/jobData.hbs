<style>
#JobData{
  max-height : 70vh; 
  overflow: hidden;
}

#jobCardContainer{
  min-height: 70vh;
}

#filter{
  min-height: 70vh;
}

#jobFetchedInto{
  min-height:70vh;
  overflow: scroll;
}

.paginationButton{
  background-color: white;
  border: 1px solid black;
  margin: 2px;
  padding: 14px;
  border-radius: 5px;
  cursor: pointer;
}

</style>

<div class="container md-container-fluid mt-5 d-flex flex-sm-row flex-column justify-content-center align-items-center bg-white border border-secondary border-opacity-50" id="JobData" >
{{!--  filterCont --}}
      <div class="d-flex flex-column justify-content-center align-items-center col-sm-3 text-white bg-info" id="filter" >
           

            <div class="col-md-10 container d-flex justify-content-between align-items-center h5">
                <span class="h5 text-white">
                     Filter
                     <i class="fa fa-filter"></i>
                </span>
               <button type="button" class="btn btn-outline-light d-md-none d-block text-white link-dark" >
                   <i class="fa fa-close"></i>
               </button>
            </div>

            <div class="container d-flex justify-content-center align-items-center">
                  <form action="" class="container">
                       <label for="Category" class="py-2 d-flex flex-column">
                          <span class="my-1" >
                             Category
                          </span>
                          <input type="text" name="Category" class="px-2 py-2 border border-secondary border-opacity-50 text-black" value="Marketing" placeholder="e.g. Marketing" id="category">
                          <ul id="mySearchUl" ></ul>
                       </label>
                        <label for="Location" class="py-2 d-flex flex-column">
                          <span class="my-1" >
                             Location
                          </span>
                          <select name="Location" id="location" class="p-2 border border-secondary border-opacity-50 text-dark">

                          </select>
                       </label>

                        <div class="container-fluid d-flex flex-wrap justify-content-between align-items-center">
                         <label for="workFromHome" class="py-2">
                          <input type="checkbox" name="workFromHome">
                          <span>
                            Work From Home
                          </span>
                        </label>
                        <label for="partTime" class="py-2">
                          <input type="checkbox" name="partTime">
                          <span>
                            Part Time
                          </span>
                       </label>
                        </div>
                        <div class="container-fluid py-2 border border-white" >
                               <div class="container-fluid d-flex align-items-center justify-content-between px-1" >
                                     <span>
                                       0k
                                     </span>
                                     <span>
                                      45K
                                     </span>
                               </div>
                             <label for="stipend" class="container-fluid" >
                                <input type="range" min = "0" and max = "45000" value="25000"  id="StipendRange" class="container-fluid" onchange="renderValue(event)" >
                                <div class="container-fluid px-1" id="renderStipend">
                                     
                                </div>
                             </label> 
                        </div>
                       <div class="container d-flex flex-wrap justify-content-between align-items-center mt-1 py-2" >
                           <input type="reset" class="btn border-0 bg-transparent text-white fw-semibold" name="Clear All" >
                           <input type="submit" class="btn btn-outline-light text-white link-info rounded-0 fw-semibold"  value="Apply Changes" >
                       </div>
                  </form>
            </div>
      </div>

{{!-- jobCont --}}
      <div class="col-sm-9 h-100 jobDataContParent bg-danger d-flex flex-column justify-content-start align-items-start position-relative overflow-auto" id="jobCardContainer" >

        {{!--  job fetcher Cont --}}
        <div class="col-sm-12 d-flex flex-column justify-content-start align-items-start" id="jobFetchedInto" ></div>
      </div>
</div>
    
{{!--  pagination --}}
   <div id="paginationCont" class="container-fluid d-flex justify-content-center align-items-center border border-secondary border-opacity-50 p-2">
       <button type="button" class="btn border border-dark mx-1" id="1" >1</button>
       <button type="button" class="btn border border-dark mx-1" id="2" >2</button>
       <button type="button" class="btn border border-dark mx-1" id="3" >3</button>
       <button type="button" class="btn border border-dark mx-1" id="4" >4</button>
       <button type="button" class="btn border border-dark mx-1" id="5" >5</button>
       <button type="button" class="btn border border-dark mx-1" id="6" >6</button>
       <button type="button" class="btn border border-dark mx-1" id="7" >7</button>
       <button type="button" class="btn border border-dark mx-1" id="8" >8</button>
       <button type="button" class="btn border border-dark mx-1" id="9" >9</button>
       <button type="button" class="btn border border-dark mx-1" id="10" >10</button>
   </div>

<script>
     
     {{!-- render public location --}}

    function getLocation(){
         var location = document.getElementById('location');

         fetch("http://localhost:7000/location")
         .then((res)=>{
                return res.json()
         }).then((data)=>{

             data.states.map((d)=>{
          
                  var content = `<option class="text-dark" value=${d.state}>${d.state}</option>`;
                   location.innerHTML += content;
             })

            {{!--  to be removed  --}}


            {{!-- function getDistrict(state){
                 data.states.map((d)=>{
                 console.log(state , d.state);
                 if(state === d.state){
                     var content = d.districts;
                     return content;
                     console.log(content , d.state , d.districts);
                 }
             })
            }
            var currentState = getDistrict(location.value); --}}
             {{!-- console.log(currentState); --}}

         })

         
    }
    {{!--  render location by default call --}}
    getLocation();


      {{!-- paginationLogic and index getter--}}
        var paginationCont = document.getElementById('paginationCont');
        var pageIndex = 1;
        paginationCont.addEventListener("click",(e)=>{
      if(e.target.tagName === 'BUTTON'){
         this.pageIndex =  e.target.innerHTML;
      }
      getter(pageIndex);
    })
      {{!--  myJobDataFetcher --}}
        async function getter(pageIndex){
        fetch('http://localhost:7000/api', 
          { method: 'POST',headers: {
            'Content-type': 'application/json; charset=UTF-8',
           },
            body: JSON.stringify({
                   "id": 17,
                   "stipend": 7192,
                   "email": "zo@email.com",
                   "companyName": "UGI Corporation",
                   "address": "1997 Hibmu Jct",
                   "jobType": "Research Specialist",
                   "description": "Cufti lo opfifep ajruh su mucawzi fot vokok wevajca go oza keuzfa siswelci gelip caemno sitrajwed imzugif soj. Zudcirpom fi razfebmab oscifol fivrub nuhenbi hulo ar eziuhun evorew boohjok bu atimazip popfavget devcucof tuwisjun viewo busme. Gos va calak ca ga mo ajgicen jimowa jiwucwuk tiewu paki pobek boh mi goltil zoele vopov. Muk dukig tozuhjod ha olnead hec jamha niik sisoh va sase mo afehoita nicirip nuno ca do gi. Gow folda ad coba zaso bef me sahkakki duv id du mi sunpothu booku jifo lemwi moroppi.",
                   "duration": 6,
                   "seats": 2,
                   "jobCategory": "Office"
           })
        })
        .then((response) => response.json())
        .then((data)=>{
                var myJobCont = document.getElementById('jobFetchedInto');
                myJobCont.innerHTML = "";
               
               {{!--  default rendered Data --}}
                   function RenderedData(data){
                        data?.slice((pageIndex-1)*50,(pageIndex-1)*50 +50).forEach((d)=>{
                        var content = `<div class="bg-white jobCard p-2 shadow m-2" id=${d.id} >
                            <div class="container JobInfo d-flex justify-content-between align-items-center py-3">
                                  <div>
                                    <h5>
                                      Intern Required for :
                                      <strong class="text-info" >
                                         ${d.jobType} 
                                      </strong>
                                      's Role 
                                    <h5>
                                  </div>
                                  <div>
                                    helperICons
                                  </div>
                            </div>

                             <div class="container border-bottom border-top border-secondary border-opacity-50 py-2 px-3 d-flex flex-row justify-content-between align-items-center text-secondary" >
                                   <div class="text-start">
                                    <span>
                                       An offer by :
                                    </span>
                                    <h5 class="text-info" >
                                      ${d.companyName}
                                    </h5>
                                   </div>
                                   <div class="text-end">
                                        <span>
                                           To Contact :
                                        </span>
                                       <h5 class="text-info">
                                        ${d.email}
                                       </h5>
                                   </div>
                            </div>

                            <div class="container py-2 px-3 d-flex flex-column justify-content-center align-items-center" >
                                 <span class="text-start h5 container-fluid">
                                    Internship Description
                                 </span>
                                 <div>
                                  <small>
                                      ${d.description}
                                  </small>
                                 </div>
                            </div>
                            <div class="px-2 container d-flex  justify-content-between align-items-center text-dark border-bottom border-top border-secondary py-2">
                                <div class="d-flex flex-column">
                                   <span class="text-dark" >
                                     Visit us on following address :
                                </span>
                                <strong class="text-secondary">
                                   ${d.address}
                                </strong>
                                </div>
                              <div class="dflex flex-column text-end">
                                  <div>
                                     Job Type : 
                                  </div>
                                   <div>
                                       <strong class="text-secondary">
                                         ${d.jobCategory}
                                       </strong>
                                    </div>
                                </div>
                            </div>
                            <div class="px-3 container d-flex justify-content-between align-items-center text-dark py-2">
                                <div class="text-dark">
                                  Seats Available :
                                  <strong>
                                    ${d.seats}
                                  </strong>
                                </div>
                                <div>
                                  <a href="http://localhost:7000/viewMore:${d.id}"class="text-decoration-none btn btn-outline-primary">
                                    View Details
                                </a>
                                </div>
                            </div>
                          </div>`;
                        myJobCont.innerHTML += content;
                })
            }
               {{!--  default Data Calling --}}
                    RenderedData(data)

               {{!--  Filtering  --}}
                 category.addEventListener("keyup",(event)=>{
                      var textInput = event.target.value;
                      var mySearchUl = document.getElementById('mySearchUl')
                      if(textInput === ""){
                        mySearchUl.innerHTML = "";
                      }else{
                         var filteredData = data.slice(0,5).filter((d)=>{
                               if(d.jobType.toUpperCase().match(textInput.toUpperCase())){
                                  mySearchUl.innerHTML += `<li class="bg-white text-black container-fluid py-2 border border-secondary border-opacity-50 searchList" style="cursor:pointer;" onclick="setCategory('${d.jobType}')" >
                                                               ${d.jobType}
                                                           </li>`;
                               }

                         })
                    {{!-- block ends here --}}
                      }             
                        
        })
         }).catch((error)=>{
            console.error('Error Gathering Data',error);
         })
    }

      {{!--  default render --}}
        getter(1);
  
     {{!--  rendering stipend --}}
        function renderValue(event){
              var renderStipend = document.getElementById('renderStipend') 
              renderStipend.innerHTML = `${event.target.value} K`;
           }
     {{!-- block ends here --}}






       {{!-- selecting categories --}}

            function setCategory(variable){
                      console.log(variable);
                      var category = document.getElementById('category')
                       category.value = variable;       
            } 











</script>